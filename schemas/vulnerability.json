{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Vulnerability Report Schema",
  "description": "Schema for vulnerability findings in security assessments",
  "type": "object",
  "required": ["id", "name", "affected_assets", "severity", "confidence"],
  "properties": {
    "id": {
      "type": "string",
      "description": "Unique identifier for this vulnerability"
    },
    "name": {
      "type": "string",
      "description": "Clear, descriptive name of the vulnerability"
    },
    "description": {
      "type": "string",
      "description": "Detailed description of the vulnerability"
    },
    "affected_assets": {
      "type": "array",
      "description": "List of affected assets",
      "items": {
        "type": "object",
        "required": ["type", "identifier"],
        "properties": {
          "type": {
            "type": "string",
            "enum": ["domain", "ip", "service", "endpoint", "cloud_resource"],
            "description": "Type of affected asset"
          },
          "identifier": {
            "type": "string",
            "description": "Identifier of the affected asset (e.g., URL, IP address)"
          },
          "path": {
            "type": "string",
            "description": "Specific path or location within the asset"
          }
        }
      }
    },
    "technical_details": {
      "type": "object",
      "description": "Technical details and evidence",
      "properties": {
        "evidence": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "List of evidence supporting the finding"
        },
        "proof_of_concept": {
          "type": "string",
          "description": "Safe proof-of-concept demonstrating the vulnerability"
        },
        "tool_output": {
          "type": "string",
          "description": "Relevant output from security tools"
        }
      }
    },
    "cve_references": {
      "type": "array",
      "description": "Related CVE identifiers",
      "items": {
        "type": "string",
        "pattern": "^CVE-[0-9]{4}-[0-9]+$"
      }
    },
    "owasp_category": {
      "type": "string",
      "description": "OWASP Top 10 category if applicable"
    },
    "cwe_id": {
      "type": "string",
      "pattern": "^CWE-[0-9]+$",
      "description": "CWE (Common Weakness Enumeration) identifier"
    },
    "severity": {
      "type": "string",
      "enum": ["critical", "high", "medium", "low", "info"],
      "description": "Severity level of the vulnerability"
    },
    "confidence": {
      "type": "string",
      "enum": ["confirmed", "likely", "possible", "inconclusive"],
      "description": "Confidence level in the finding"
    },
    "cvss_score": {
      "type": "number",
      "minimum": 0,
      "maximum": 10,
      "description": "CVSS score if applicable"
    },
    "likelihood": {
      "type": "string",
      "enum": ["high", "medium", "low"],
      "description": "Likelihood of exploitation"
    },
    "impact": {
      "type": "string",
      "description": "Potential impact if exploited"
    },
    "remediation": {
      "type": "object",
      "description": "Remediation recommendations",
      "properties": {
        "recommendations": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "List of specific remediation steps"
        },
        "priority": {
          "type": "string",
          "enum": ["immediate", "high", "medium", "low"],
          "description": "Priority for remediation"
        },
        "effort": {
          "type": "string",
          "enum": ["low", "medium", "high"],
          "description": "Estimated effort to remediate"
        }
      }
    },
    "discovered_at": {
      "type": "string",
      "format": "date-time",
      "description": "ISO-8601 timestamp when discovered"
    },
    "discovered_by": {
      "type": "string",
      "description": "Tool or method that discovered this vulnerability"
    },
    "validated": {
      "type": "boolean",
      "description": "Whether the vulnerability has been validated"
    },
    "false_positive": {
      "type": "boolean",
      "description": "Whether this has been identified as a false positive"
    }
  }
}
